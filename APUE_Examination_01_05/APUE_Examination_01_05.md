# ---------------- `APUE` 阶段性检测 -------------
* **检测范围: Chapter 1 ~ Chapter 5**

* **题型：填空题、编程题、实验探究题**

* **试卷满分：300分**
****

### 一、填空题（50分）
1. 请为右侧名词作出定义，**内核**是 ___________________、**系统调用（`system call`）**是 _____________________、**公用库函数**是 ________________________、**`shell`** 是 _________________________。
2. 在 `Linux` 操作系统中，用户的登录名取自 _____________________ 文件中的登陆项，此登陆项中包含有下列信息：________、 _________、 _________、 ________、 ________、 ________、 ________。
3. 请描述 `相对路径` 和 `绝对路径` 的区别：_______________________。
4. 文件描述符是指 _____________________________、不同进程间的文件描述符 ________ （***会/不会***）相同，原因是 ___________________ 。
5. 描述 `shell` 命令 `prog1 < inputfile | prog2 | prog3 > outputfile` 的作用  ___________________________________________________________________
_______________________________________________。
6. 信号的作用是 ________________________________、操作系统有三种处理信号的方式，分别为 ____________________________、_________________________、__________________________________。为相应的信号注册捕获函数可以使用 ___________________ （***填写函数原型***），____________________（***填写函数原型***）。
7. `wall clock time` 指的是 ______________________、`用户 CPU 时间` 指的是 _________________________、`系统 CPU 时间`指的是 _________________________。 
8. `带缓冲的 I/O` 一词中，`缓冲`指的是 __________________，`带缓冲的 I/O` 其优势在于 _______________________________________________________。 
9. 分别解释下列标志位的作用：`O_EXCL`，`O_APPEND`，`O_TRUNC`，
`O_SYNC`，`O_DSYNC`，`O_NONFOLLOW`：_________________________________________________________________ _________________________________________________________________
_________________________________________________________________ _________________________________________________________________
__________________________。
10. 描述两种获取文件大小的方式 _________________________________________________________________ _________________________________________________________________
_______。

-
### 三、编程题（80分）

1、 实现下列代码中所需的宏函数 `LOG(format, ...)` ，并将其编写在文件 `exam_prog1.c` 中，按如下所示导入头文件，编译运行程序，完成如图所示的输出。 

```C
#include "exam_prog1.c"

int main(int argc, char *argv[]) {
	
	char buf[10 << 10] = { 0 };
    setvbuf(stdout, buf, _IOFBF, sizeof(buf));
    printf(" ShenZheng, ");
    printf("Nice to meet you\n");
    
    LOG("Good morning, ");
    LOG("I'm %s, and I live in", "Hanson");
    char *ptr = NULL;
    LOG(ptr);

    fflush(stdout);
    _exit(0);    
}
```

***输出如下***
![](/Users/bot/Desktop/APUE/APUE/APUE_Examination_01_05/pro1.input.png)

2、使用 `dup(int fd)` 实现 `my_dup2(int fd)` 函数，并将其编写在文件 `exam_prog2.c` 中，按如下方式导入头文件，编译运行程序，完成如图所示的输出。

```C
#include "exam_prog2.c"

int main(int argc, char *argv[]) {
    
    close(2);
    if (my_dup2(2, 5) < 0) 
        printf("my_dup2 fail 1: %s\n", strerror(errno));
    else
        printf("my_dup2 succ 1\n");

    if (my_dup2(1, 1000) < 0) 
        printf("my_dup2 fail 2: %s\n", strerror(errno));
    else
        printf("my_dup2 succ 2\n");

    int fd = open("test_file", O_RDWR | O_CREAT | O_TRUNC, 0644);
    if (my_dup2(1, fd) < 0)
        printf("my_dup2 fail 3: %s\n", strerror(errno));
    else
        printf("my_dup2 succ 3\n");

    const char *ptr = "hello world to stdout\n";
    write(fd, ptr, strlen(ptr));

    if (my_dup2(1, 1) < 0)
        printf("my_dup2 fail 4: %s\n", strerror(errno));
    else
        printf("my_dup2 succ 4\n");
    
    return 0;    
}
```

![](/Users/bot/Desktop/APUE/APUE/APUE_Examination_01_05/prog2.input.png )







	
	






 
